{"version":3,"file":"nunjucks-template-parser.js","sources":["../src/nunjucks-template-parser.ts"],"sourcesContent":["import { TemplateParser, TemplateData } from \"@taprootio/rollup-plugin-taproot\"\nimport nunjucks from \"nunjucks\"\n\ninterface NunjucksFilterDef {\n  Name: string\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  Filter: (...args: any[]) => any\n  Async: boolean\n}\n\nconst NunjucksTemplateParser = (\n  options: nunjucks.ConfigureOptions,\n  filters: Array<NunjucksFilterDef>\n): TemplateParser => {\n  nunjucks.configure(options)\n  const nunjucksEnv = new nunjucks.Environment()\n\n  for (const filter of filters) {\n    nunjucksEnv.addFilter(filter.Name, filter.Filter, filter.Async)\n  }\n\n  return {\n    FileMatcher: new RegExp(\"([a-zA-Z0-9s_\\\\.-:])+(.njk)$\"),\n    CompileTemplate: (template: string) => {\n      const compiled = nunjucks.compile(template, nunjucksEnv)\n\n      return {\n        Render: (data: TemplateData) => {\n          return compiled.render(data)\n        },\n      }\n    },\n  }\n}\n\nexport { NunjucksTemplateParser }\n"],"names":["nunjucks"],"mappings":";;;;;;;;;;AAUA,MAAM,sBAAsB,GAAG,CAC7B,OAAkC,EAClC,OAAiC,KACf;AAClB,IAAAA,4BAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,CAAA;AAC3B,IAAA,MAAM,WAAW,GAAG,IAAIA,4BAAQ,CAAC,WAAW,EAAE,CAAA;AAE9C,IAAA,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;AAC5B,QAAA,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,CAAA;AAChE,KAAA;IAED,OAAO;AACL,QAAA,WAAW,EAAE,IAAI,MAAM,CAAC,8BAA8B,CAAC;AACvD,QAAA,eAAe,EAAE,CAAC,QAAgB,KAAI;YACpC,MAAM,QAAQ,GAAGA,4BAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAA;YAExD,OAAO;AACL,gBAAA,MAAM,EAAE,CAAC,IAAkB,KAAI;AAC7B,oBAAA,OAAO,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;iBAC7B;aACF,CAAA;SACF;KACF,CAAA;AACH;;;;"}